<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Find My Mechanic</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #fffbea;
      color: #333;
    }
    .navbar {
      background-color: #ffd700;
    }
    .form-control, .btn {
      border-radius: 10px;
    }
    .card {
      border-radius: 15px;
      border: 1px solid #ffd700;
    }
    .approved {
      color: green;
      font-weight: bold;
    }
  </style>

  <!-- Firebase App (Core) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>

  <!-- Firestore (Database) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
</head>
<body>

<nav class="navbar navbar-light">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">Find My Mechanic</span>
  </div>
</nav>

<div class="container my-4">
  <h3 class="mb-3">Mechanic Registration</h3>
  <form id="mechanicForm">
    <div class="row mb-2">
      <div class="col">
        <input type="text" class="form-control" placeholder="Full Name" id="name" required />
      </div>
      <div class="col">
        <input type="text" class="form-control" placeholder="Phone Number" id="phone" required />
      </div>
    </div>
    <input type="text" class="form-control mb-2" placeholder="Location (City)" id="location" required />
    <input type="text" class="form-control mb-2" placeholder="Vehicle Types (e.g. Bike, Car)" id="vehicle" required />
    <input type="number" class="form-control mb-2" placeholder="Experience (in years)" id="experience" required />
    <textarea class="form-control mb-2" placeholder="Any Description or Skills" id="description"></textarea>
    <button type="submit" class="btn btn-warning">Register</button>
  </form>

  <hr class="my-4">

  <h3 class="mb-3">Available Mechanics</h3>
  <div id="mechanicList" class="row"></div>
</div>

<!-- Firebase Initialization -->
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCjc5AVGj18SOiEdyzuepffcyOJXB9FVz4",
    authDomain: "find-my-mechanic-ee65d.firebaseapp.com",
    projectId: "find-my-mechanic-ee65d",
    storageBucket: "find-my-mechanic-ee65d.firebasestorage.app",
    messagingSenderId: "1044407480698",
    appId: "1:1044407480698:web:54bcc09f8579038e80e6c3"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>

<!-- Main Script -->
<script>
  const form = document.getElementById('mechanicForm');
  const mechanicList = document.getElementById('mechanicList');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value;
    const phone = document.getElementById('phone').value;
    const location = document.getElementById('location').value;
    const vehicle = document.getElementById('vehicle').value;
    const experience = document.getElementById('experience').value;
    const description = document.getElementById('description').value;

    await db.collection('mechanics').add({
      name,
      phone,
      location,
      vehicle,
      experience,
      description,
      approved: false  // Admin has to approve manually
    });

    alert("Registration submitted! Admin will review your profile.");
    form.reset();
  });

  async function loadMechanics() {
    const querySnapshot = await db.collection("mechanics").get();
    mechanicList.innerHTML = '';
    querySnapshot.forEach((doc) => {
      const data = doc.data();
      const card = `
        <div class="col-md-4 mb-3">
          <div class="card p-3">
            <h5>${data.name} ${data.approved ? '<span class="approved">&#10004;</span>' : ''}</h5>
            <p><strong>Phone:</strong> ${data.phone}</p>
            <p><strong>Location:</strong> ${data.location}</p>
            <p><strong>Vehicle Type:</strong> ${data.vehicle}</p>
            <p><strong>Experience:</strong> ${data.experience} years</p>
            <p>${data.description}</p>
          </div>
        </div>
      `;
      mechanicList.innerHTML += card;
    });
  }

  loadMechanics();
</script>

</body>
</html>
