<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Book a Mechanic</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body {
      background-color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
    }
    .gold-bg { background-color: #d4af37; color: white; }
    .container { max-width: 900px; margin-top: 50px; }
    .urgent-fee { color: red; font-weight: bold; }
  </style>
</head>
<body>

  <nav class="navbar gold-bg">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="index.html">Find My Mechanic</a>
    </div>
  </nav>

  <div class="container">
    <h2>Book a Mechanic</h2>
    <form id="bookingForm">
      <div class="mb-3">
        <label for="location" class="form-label">Location</label>
        <input type="text" class="form-control" id="location" placeholder="Enter your location" required/>
      </div>
      <div class="mb-3">
        <label for="vehicleType" class="form-label">Vehicle Type</label>
        <select class="form-select" id="vehicleType" required>
          <option value="">Select Vehicle Type</option>
          <option value="Bike">Bike</option>
          <option value="Car">Car</option>
          <option value="Others">Others</option>
        </select>
      </div>
      <div class="mb-3" id="brandSelection">
        <!-- Brand selection will be dynamically generated here -->
      </div>
      <div class="mb-3">
        <label for="urgency" class="form-label">Urgency</label>
        <select class="form-select" id="urgency" required>
          <option value="Normal">Normal</option>
          <option value="Urgent">Urgent (+100)</option>
        </select>
      </div>
      <button type="submit" class="btn gold-bg w-100">Book Mechanic</button>
    </form>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
    apiKey: "AIzaSyCjc5AVGj18SOiEdyzuepffcyOJXB9FVz4",
  authDomain: "find-my-mechanic-ee65d.firebaseapp.com",
  projectId: "find-my-mechanic-ee65d",
  storageBucket: "find-my-mechanic-ee65d.firebasestorage.app",
  messagingSenderId: "1044407480698",
  appId: "1:1044407480698:web:54bcc09f8579038e80e6c3"

    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Update Brand selection based on Vehicle Type
    document.getElementById('vehicleType').addEventListener('change', (event) => {
      const vehicleType = event.target.value;
      const brandSelection = document.getElementById('brandSelection');

      if (vehicleType === "Bike") {
        brandSelection.innerHTML = `
          <label for="brand" class="form-label">Brand</label>
          <select class="form-select" id="brand" required>
            <option value="">Select Brand</option>
            <option value="Royal Enfield">Royal Enfield</option>
            <option value="Bajaj">Bajaj</option>
            <option value="Honda">Honda</option>
            <option value="Yamaha">Yamaha</option>
            <option value="Hero">Hero</option>
          </select>
        `;
      } else if (vehicleType === "Car") {
        brandSelection.innerHTML = `
          <label for="brand" class="form-label">Brand</label>
          <select class="form-select" id="brand" required>
            <option value="">Select Brand</option>
            <option value="Toyota">Toyota</option>
            <option value="Honda">Honda</option>
            <option value="Ford">Ford</option>
            <option value="BMW">BMW</option>
            <option value="Maruti">Maruti</option>
          </select>
        `;
      } else {
        brandSelection.innerHTML = ''; // No brand selection for 'Others'
      }
    });

    // Handle booking form submission
    document.getElementById('bookingForm').addEventListener('submit', (event) => {
      event.preventDefault();

      const location = document.getElementById('location').value;
      const vehicleType = document.getElementById('vehicleType').value;
      const brand = document.getElementById('brand') ? document.getElementById('brand').value : 'N/A';
      const urgency = document.getElementById('urgency').value;
      const extraFee = urgency === "Urgent" ? 100 : 0;

      // Save booking details to Firebase
      const bookingRef = db.ref('bookings').push();
      bookingRef.set({
        location: location,
        vehicleType: vehicleType,
        brand: brand,
        urgency: urgency,
        extraFee: extraFee,
        timestamp: new Date().toISOString()
      }).then(() => {
        alert('Your booking has been submitted!');
        window.location.href = 'index.html'; // Redirect to home page
      }).catch((error) => {
        alert('Booking failed: ' + error.message);
      });
    });
  </script>

</body>
</html>
